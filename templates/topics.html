{% extends "base.html" %}
{% block content %}
    <h3 class="center-align">Terms by topic</h3>
    <h5 class="center-align">Click a topic to reveal the related terms.</h5>

    <!--Makes add topic button available to admin alone-->
    {% if session["user"] == "rossclark" %}
    <div class="row">
        <div id="add-topic_btn" class="col s12 center-align">
            <a href="{{ url_for('add_topic') }}" class="btn-large red darken-4">
                Add topic <i class="fas fa-plus-square right"></i>
            </a>
        </div>
    </div>
    {% endif %}

    <div class="row">
        {% for topic in topics %}
        <!--Adds class to topic cards to increase margins in admin view-->
            {% if session["user"] == "rossclark" %}
                <div class="col s12 m4 topic_img topic-card">
            {% else %}
                <div class="col s12 m4 topic_img">
            {% endif %}
                    <div class="card">
                        <div class="card-image">
                            <!--Images via URL to allow new images to be uploaded 
                            when admin adds a new category -->
                            <img src="{{ topic.img_url }}">
                        </div>
                        <!--Makes edit and delete topic buttons available only to admin-->
                        {% if session["user"] != "rossclark" %}
                            <div class="card-action center-align">
                                <a href="#" class="btn red darken-4 topic-btn">{{ topic.topic_name }}</a>
                            </div>
                        {% else %}
                            <div class="card-action center-align">
                                <a href="#" class="btn green darken-4 topic-btn">{{ topic.topic_name }}</a>
                            </div>
                            <div class="card-action center-align">
                                <a href="{{ url_for('edit_topic', topic_id=topic._id) }}" 
                                class="btn amber darken-4 topic-btn">Edit</a>
                            </div>
                            <div class="card-action center-align">
                            <!-- Modal Trigger -->
                            <!--href and id set to 'modal{{ loop.index }}' as each modal needs a unique id-->
                                <a class=" btn modal-trigger topic-btn red darken-1" href="#modal{{ loop.index }}">Delete</a>
                                <!-- Modal Structure -->
                                <div id="modal{{ loop.index }}" class="modal modal-fixed-footer">
                                    <div class="modal-content black-text center-align">
                                        <h2>Do you really want to delete this topic?</h2>
                                        <a href="{{ url_for('delete_topic', topic_id=topic._id) }}" 
                                        class="modal-close red darken-4 btn-large">Yes</a>
                                        <a href="#!" class="modal-close amber darken-4 btn-large">No</a>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
        {% endfor %}
    </div>
{% endblock %}